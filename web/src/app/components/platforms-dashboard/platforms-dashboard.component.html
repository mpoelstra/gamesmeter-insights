<article class="platforms">
  <div class="card signatures">
    <div class="head">
      <h3>{{ i18n.t('platforms.signatures') }}</h3>
      <p class="muted">{{ i18n.t('platforms.signatures.subtitle') }}</p>
    </div>
    @if (signature()) {
      <div class="signature-grid">
        <app-platform-stat-card
          [label]="i18n.t('platforms.mostPlayed')"
          [value]="signature()!.mostPlayed.name"
          [meta]="signature()!.mostPlayed.count + ' ' + i18n.t('label.games')"
        >
          <app-platform-logo
            stat-logo
            [src]="platformImage(signature()!.mostPlayed.name).src"
            [alt]="signature()!.mostPlayed.name"
            [size]="26"
          />
        </app-platform-stat-card>
        <app-platform-stat-card
          [label]="i18n.t('platforms.highestAvg')"
          [value]="signature()!.highestAvg.name"
          [meta]="i18n.t('label.avg') + ' ' + signature()!.highestAvg.average.toFixed(2)"
        >
          <app-platform-logo
            stat-logo
            [src]="platformImage(signature()!.highestAvg.name).src"
            [alt]="signature()!.highestAvg.name"
            [size]="26"
          />
        </app-platform-stat-card>
        <app-platform-stat-card
          [label]="i18n.t('platforms.mostConsistent')"
          [value]="signature()!.consistent?.name ?? i18n.t('label.na')"
          [meta]="i18n.t('stats.stdDev') + ' ' + (signature()!.consistent?.stdDev.toFixed(2) ?? '—')"
        >
          <app-platform-logo
            stat-logo
            [src]="platformImage(signature()!.consistent?.name).src"
            [alt]="signature()!.consistent?.name ?? i18n.t('label.platformUnknown')"
            [size]="26"
          />
        </app-platform-stat-card>
      </div>
    }
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.eraPeaks') }}</h3>
      <p class="muted">{{ i18n.t('platforms.eraPeaks.subtitle') }}</p>
    </div>
    <div class="era-grid">
      @for (era of eraPeaks(); track era.era) {
        <app-platform-stat-card
          [label]="era.era"
          [value]="era.platform"
          [meta]="i18n.t('label.avg') + ' ' + era.average.toFixed(2) + ' · ' + era.count + ' ' + i18n.t('label.games')"
        >
          <app-platform-logo
            stat-logo
            [src]="platformImage(era.platform).src"
            [alt]="era.platform"
            [size]="26"
          />
        </app-platform-stat-card>
      }
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.eraLows') }}</h3>
      <p class="muted">{{ i18n.t('platforms.eraLows.subtitle') }}</p>
    </div>
    <div class="era-grid">
      @for (era of eraLows(); track era.era) {
        <app-platform-stat-card
          [label]="era.era"
          [value]="era.platform"
          [meta]="i18n.t('label.avg') + ' ' + era.average.toFixed(2) + ' · ' + era.count + ' ' + i18n.t('label.games')"
          variant="low"
        >
          <app-platform-logo
            stat-logo
            [src]="platformImage(era.platform).src"
            [alt]="era.platform"
            [size]="26"
          />
        </app-platform-stat-card>
      }
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.timelineRibbons') }}</h3>
      <p class="muted">{{ i18n.t('platforms.timelineRibbons.subtitle') }}</p>
    </div>
    <div class="chart">
      <canvas baseChart [type]="chartTypeLine" [data]="ribbonData" [options]="ribbonOptions"></canvas>
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.eraBands') }}</h3>
      <p class="muted">{{ i18n.t('platforms.eraBands.subtitle') }}</p>
    </div>
    <div class="chart">
      <canvas baseChart [type]="chartTypeLine" [data]="eraBandsData" [options]="eraBandsOptions"></canvas>
    </div>
    <p class="note">{{ i18n.t('platforms.eraBands.note') }}</p>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.platformDrift') }}</h3>
      <p class="muted">{{ i18n.t('platforms.platformDrift.subtitle') }}</p>
    </div>
    <div class="chart">
      <canvas baseChart [type]="chartTypeBubble" [data]="bubbleData" [options]="bubbleOptions"></canvas>
    </div>
  </div>
</article>
