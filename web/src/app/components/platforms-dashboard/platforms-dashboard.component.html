<article class="platforms">
  <div class="card signatures">
    <div class="head">
      <h3>{{ i18n.t('platforms.signatures') }}</h3>
      <p class="muted">{{ i18n.t('platforms.signatures.subtitle') }}</p>
    </div>
    @if (signature()) {
      <div class="signature-grid">
        <div class="sig">
          <p class="label">{{ i18n.t('platforms.mostPlayed') }}</p>
          <div class="sig-line">
            <img
              class="platform-logo"
              [src]="platformImage(signature()!.mostPlayed.name).src"
              [alt]="signature()!.mostPlayed.name"
              loading="lazy"
              decoding="async"
            />
            <p class="value">{{ signature()!.mostPlayed.name }}</p>
          </div>
          <p class="muted">{{ signature()!.mostPlayed.count }} {{ i18n.t('label.games') }}</p>
        </div>
        <div class="sig">
          <p class="label">{{ i18n.t('platforms.highestAvg') }}</p>
          <div class="sig-line">
            <img
              class="platform-logo"
              [src]="platformImage(signature()!.highestAvg.name).src"
              [alt]="signature()!.highestAvg.name"
              loading="lazy"
              decoding="async"
            />
            <p class="value">{{ signature()!.highestAvg.name }}</p>
          </div>
          <p class="muted">{{ i18n.t('label.avg') }} {{ signature()!.highestAvg.average.toFixed(2) }}</p>
        </div>
        <div class="sig">
          <p class="label">{{ i18n.t('platforms.mostConsistent') }}</p>
          <div class="sig-line">
            <img
              class="platform-logo"
              [src]="platformImage(signature()!.consistent?.name).src"
              [alt]="signature()!.consistent?.name ?? i18n.t('label.platformUnknown')"
              loading="lazy"
              decoding="async"
            />
            <p class="value">{{ signature()!.consistent?.name ?? i18n.t('label.na') }}</p>
          </div>
          <p class="muted">{{ i18n.t('stats.stdDev') }} {{ signature()!.consistent?.stdDev.toFixed(2) ?? '—' }}</p>
        </div>
      </div>
    }
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.eraPeaks') }}</h3>
      <p class="muted">{{ i18n.t('platforms.eraPeaks.subtitle') }}</p>
    </div>
    <div class="era-grid">
      @for (era of eraPeaks(); track era.era) {
        <div class="era">
          <p class="label">{{ era.era }}</p>
          <div class="sig-line">
            <img
              class="platform-logo"
              [src]="platformImage(era.platform).src"
              [alt]="era.platform"
              loading="lazy"
              decoding="async"
            />
            <p class="value">{{ era.platform }}</p>
          </div>
          <p class="muted">{{ i18n.t('label.avg') }} {{ era.average.toFixed(2) }} · {{ era.count }} {{ i18n.t('label.games') }}</p>
        </div>
      }
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.eraLows') }}</h3>
      <p class="muted">{{ i18n.t('platforms.eraLows.subtitle') }}</p>
    </div>
    <div class="era-grid">
      @for (era of eraLows(); track era.era) {
        <div class="era low">
          <p class="label">{{ era.era }}</p>
          <div class="sig-line">
            <img
              class="platform-logo"
              [src]="platformImage(era.platform).src"
              [alt]="era.platform"
              loading="lazy"
              decoding="async"
            />
            <p class="value">{{ era.platform }}</p>
          </div>
          <p class="muted">{{ i18n.t('label.avg') }} {{ era.average.toFixed(2) }} · {{ era.count }} {{ i18n.t('label.games') }}</p>
        </div>
      }
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.timelineRibbons') }}</h3>
      <p class="muted">{{ i18n.t('platforms.timelineRibbons.subtitle') }}</p>
    </div>
    <div class="chart">
      <canvas baseChart [type]="chartTypeLine" [data]="ribbonData" [options]="ribbonOptions"></canvas>
    </div>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.eraBands') }}</h3>
      <p class="muted">{{ i18n.t('platforms.eraBands.subtitle') }}</p>
    </div>
    <div class="chart">
      <canvas baseChart [type]="chartTypeLine" [data]="eraBandsData" [options]="eraBandsOptions"></canvas>
    </div>
    <p class="note">{{ i18n.t('platforms.eraBands.note') }}</p>
  </div>

  <div class="card">
    <div class="head">
      <h3>{{ i18n.t('platforms.platformDrift') }}</h3>
      <p class="muted">{{ i18n.t('platforms.platformDrift.subtitle') }}</p>
    </div>
    <div class="chart">
      <canvas baseChart [type]="chartTypeBubble" [data]="bubbleData" [options]="bubbleOptions"></canvas>
    </div>
  </div>
</article>
